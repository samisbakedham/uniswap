{"ast":null,"code":"import _toConsumableArray from\"/Users/safahi/Downloads/interface-4.30.1/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"/Users/safahi/Downloads/interface-4.30.1/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _styled from\"styled-components\";import{Trans}from\"@lingui/react\";import{i18n}from\"@lingui/core\";import useDebounce from'hooks/useDebounce';import{useOnClickOutside}from'hooks/useOnClickOutside';import useTheme from'hooks/useTheme';import useToggle from'hooks/useToggle';import{useCallback,useEffect,useMemo,useRef,useState}from'react';import{Edit}from'react-feather';import ReactGA from'react-ga';import AutoSizer from'react-virtualized-auto-sizer';import{Text}from'rebass';import{useAllTokens,useIsUserAddedToken,useNativeCurrency,useSearchInactiveTokenLists,useToken}from'../../hooks/Tokens';import{useActiveWeb3React}from'../../hooks/web3';import{ButtonText,CloseIcon,IconWrapper,ThemedText}from'../../theme';import{isAddress}from'../../utils';import Column from'../Column';import Row,{RowBetween,RowFixed}from'../Row';import CommonBases from'./CommonBases';import CurrencyList from'./CurrencyList';import{filterTokens,useSortedTokensByQuery}from'./filtering';import ImportRow from'./ImportRow';import{useTokenComparator}from'./sorting';import{PaddedColumn,SearchInput,Separator}from'./styleds';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var ContentWrapper=_styled(Column).withConfig({componentId:\"sc-1it7zu4-0\"})([\"width:100%;flex:1 1;position:relative;\"]);var Footer=_styled.div.withConfig({componentId:\"sc-1it7zu4-1\"})([\"width:100%;border-radius:20px;padding:20px;border-top-left-radius:0;border-top-right-radius:0;background-color:\",\";border-top:1px solid \",\";\"],function(_ref){var theme=_ref.theme;return theme.bg1;},function(_ref2){var theme=_ref2.theme;return theme.bg2;});export function CurrencySearch(_ref3){var selectedCurrency=_ref3.selectedCurrency,onCurrencySelect=_ref3.onCurrencySelect,otherSelectedCurrency=_ref3.otherSelectedCurrency,showCommonBases=_ref3.showCommonBases,showCurrencyAmount=_ref3.showCurrencyAmount,disableNonToken=_ref3.disableNonToken,onDismiss=_ref3.onDismiss,isOpen=_ref3.isOpen,showManageView=_ref3.showManageView,showImportView=_ref3.showImportView,setImportToken=_ref3.setImportToken;var _useActiveWeb3React=useActiveWeb3React(),chainId=_useActiveWeb3React.chainId;var theme=useTheme();// refs for fixed size lists\nvar fixedList=useRef();var _useState=useState(''),_useState2=_slicedToArray(_useState,2),searchQuery=_useState2[0],setSearchQuery=_useState2[1];var debouncedQuery=useDebounce(searchQuery,200);var _useState3=useState(false),_useState4=_slicedToArray(_useState3,1),invertSearchOrder=_useState4[0];var allTokens=useAllTokens();// if they input an address, use it\nvar isAddressSearch=isAddress(debouncedQuery);var searchToken=useToken(debouncedQuery);var searchTokenIsAdded=useIsUserAddedToken(searchToken);useEffect(function(){if(isAddressSearch){ReactGA.event({category:'Currency Select',action:'Search by address',label:isAddressSearch});}},[isAddressSearch]);var tokenComparator=useTokenComparator(invertSearchOrder);var filteredTokens=useMemo(function(){return filterTokens(Object.values(allTokens),debouncedQuery);},[allTokens,debouncedQuery]);var sortedTokens=useMemo(function(){return filteredTokens.sort(tokenComparator);},[filteredTokens,tokenComparator]);var filteredSortedTokens=useSortedTokensByQuery(sortedTokens,debouncedQuery);var native=useNativeCurrency();var filteredSortedTokensWithETH=useMemo(function(){var _native$symbol,_native$symbol$toLowe;if(!native)return filteredSortedTokens;var s=debouncedQuery.toLowerCase().trim();if(((_native$symbol=native.symbol)===null||_native$symbol===void 0?void 0:(_native$symbol$toLowe=_native$symbol.toLowerCase())===null||_native$symbol$toLowe===void 0?void 0:_native$symbol$toLowe.indexOf(s))!==-1){return native?[native].concat(_toConsumableArray(filteredSortedTokens)):filteredSortedTokens;}return filteredSortedTokens;},[debouncedQuery,native,filteredSortedTokens]);var handleCurrencySelect=useCallback(function(currency){onCurrencySelect(currency);onDismiss();},[onDismiss,onCurrencySelect]);// clear the input on open\nuseEffect(function(){if(isOpen)setSearchQuery('');},[isOpen]);// manage focus on modal show\nvar inputRef=useRef();var handleInput=useCallback(function(event){var _fixedList$current;var input=event.target.value;var checksummedInput=isAddress(input);setSearchQuery(checksummedInput||input);(_fixedList$current=fixedList.current)===null||_fixedList$current===void 0?void 0:_fixedList$current.scrollTo(0);},[]);var handleEnter=useCallback(function(e){if(e.key==='Enter'){var _native$symbol2;var s=debouncedQuery.toLowerCase().trim();if(s===(native===null||native===void 0?void 0:(_native$symbol2=native.symbol)===null||_native$symbol2===void 0?void 0:_native$symbol2.toLowerCase())){handleCurrencySelect(native);}else if(filteredSortedTokensWithETH.length>0){var _filteredSortedTokens;if(((_filteredSortedTokens=filteredSortedTokensWithETH[0].symbol)===null||_filteredSortedTokens===void 0?void 0:_filteredSortedTokens.toLowerCase())===debouncedQuery.trim().toLowerCase()||filteredSortedTokensWithETH.length===1){handleCurrencySelect(filteredSortedTokensWithETH[0]);}}}},[debouncedQuery,native,filteredSortedTokensWithETH,handleCurrencySelect]);// menu ui\nvar _useToggle=useToggle(false),_useToggle2=_slicedToArray(_useToggle,2),open=_useToggle2[0],toggle=_useToggle2[1];var node=useRef();useOnClickOutside(node,open?toggle:undefined);// if no results on main list, show option to expand into inactive\nvar filteredInactiveTokens=useSearchInactiveTokenLists(filteredTokens.length===0||debouncedQuery.length>2&&!isAddressSearch?debouncedQuery:undefined);return/*#__PURE__*/_jsxs(ContentWrapper,{children:[/*#__PURE__*/_jsxs(PaddedColumn,{gap:\"16px\",children:[/*#__PURE__*/_jsxs(RowBetween,{children:[/*#__PURE__*/_jsx(Text,{fontWeight:500,fontSize:16,children:/*#__PURE__*/_jsx(Trans,{id:\"Select a token\"})}),/*#__PURE__*/_jsx(CloseIcon,{onClick:onDismiss})]}),/*#__PURE__*/_jsx(Row,{children:/*#__PURE__*/_jsx(SearchInput,{type:\"text\",id:\"token-search-input\",placeholder:/*i18n*/i18n._(\"Search name or paste address\"),autoComplete:\"off\",value:searchQuery,ref:inputRef,onChange:handleInput,onKeyDown:handleEnter})}),showCommonBases&&/*#__PURE__*/_jsx(CommonBases,{chainId:chainId,onSelect:handleCurrencySelect,selectedCurrency:selectedCurrency})]}),/*#__PURE__*/_jsx(Separator,{}),searchToken&&!searchTokenIsAdded?/*#__PURE__*/_jsx(Column,{style:{padding:'20px 0',height:'100%'},children:/*#__PURE__*/_jsx(ImportRow,{token:searchToken,showImportView:showImportView,setImportToken:setImportToken})}):(filteredSortedTokens===null||filteredSortedTokens===void 0?void 0:filteredSortedTokens.length)>0||(filteredInactiveTokens===null||filteredInactiveTokens===void 0?void 0:filteredInactiveTokens.length)>0?/*#__PURE__*/_jsx(\"div\",{style:{flex:'1'},children:/*#__PURE__*/_jsx(AutoSizer,{disableWidth:true,children:function children(_ref4){var height=_ref4.height;return/*#__PURE__*/_jsx(CurrencyList,{height:height,currencies:disableNonToken?filteredSortedTokens:filteredSortedTokensWithETH,otherListTokens:filteredInactiveTokens,onCurrencySelect:handleCurrencySelect,otherCurrency:otherSelectedCurrency,selectedCurrency:selectedCurrency,fixedListRef:fixedList,showImportView:showImportView,setImportToken:setImportToken,showCurrencyAmount:showCurrencyAmount});}})}):/*#__PURE__*/_jsx(Column,{style:{padding:'20px',height:'100%'},children:/*#__PURE__*/_jsx(ThemedText.Main,{color:theme.text3,textAlign:\"center\",mb:\"20px\",children:/*#__PURE__*/_jsx(Trans,{id:\"No results found.\"})})}),/*#__PURE__*/_jsx(Footer,{children:/*#__PURE__*/_jsx(Row,{justify:\"center\",children:/*#__PURE__*/_jsx(ButtonText,{onClick:showManageView,color:theme.primary1,className:\"list-token-manage-button\",children:/*#__PURE__*/_jsxs(RowFixed,{children:[/*#__PURE__*/_jsx(IconWrapper,{size:\"16px\",marginRight:\"6px\",stroke:theme.primaryText1,children:/*#__PURE__*/_jsx(Edit,{})}),/*#__PURE__*/_jsx(ThemedText.Main,{color:theme.primaryText1,children:/*#__PURE__*/_jsx(Trans,{id:\"Manage Token Lists\"})})]})})})})]});}","map":{"version":3,"sources":["/Users/safahi/Downloads/interface-4.30.1/src/components/SearchModal/CurrencySearch.tsx"],"names":["useDebounce","useOnClickOutside","useTheme","useToggle","useCallback","useEffect","useMemo","useRef","useState","Edit","ReactGA","AutoSizer","Text","useAllTokens","useIsUserAddedToken","useNativeCurrency","useSearchInactiveTokenLists","useToken","useActiveWeb3React","ButtonText","CloseIcon","IconWrapper","ThemedText","isAddress","Column","Row","RowBetween","RowFixed","CommonBases","CurrencyList","filterTokens","useSortedTokensByQuery","ImportRow","useTokenComparator","PaddedColumn","SearchInput","Separator","ContentWrapper","styled","Footer","div","theme","bg1","bg2","CurrencySearch","selectedCurrency","onCurrencySelect","otherSelectedCurrency","showCommonBases","showCurrencyAmount","disableNonToken","onDismiss","isOpen","showManageView","showImportView","setImportToken","chainId","fixedList","searchQuery","setSearchQuery","debouncedQuery","invertSearchOrder","allTokens","isAddressSearch","searchToken","searchTokenIsAdded","event","category","action","label","tokenComparator","filteredTokens","Object","values","sortedTokens","sort","filteredSortedTokens","native","filteredSortedTokensWithETH","s","toLowerCase","trim","symbol","indexOf","handleCurrencySelect","currency","inputRef","handleInput","input","target","value","checksummedInput","current","scrollTo","handleEnter","e","key","length","open","toggle","node","undefined","filteredInactiveTokens","padding","height","flex","text3","primary1","primaryText1"],"mappings":"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","sourcesContent":["// eslint-disable-next-line no-restricted-imports\nimport { t, Trans } from '@lingui/macro'\nimport { Currency, Token } from '@uniswap/sdk-core'\nimport useDebounce from 'hooks/useDebounce'\nimport { useOnClickOutside } from 'hooks/useOnClickOutside'\nimport useTheme from 'hooks/useTheme'\nimport useToggle from 'hooks/useToggle'\nimport { KeyboardEvent, RefObject, useCallback, useEffect, useMemo, useRef, useState } from 'react'\nimport { Edit } from 'react-feather'\nimport ReactGA from 'react-ga'\nimport AutoSizer from 'react-virtualized-auto-sizer'\nimport { FixedSizeList } from 'react-window'\nimport { Text } from 'rebass'\nimport styled from 'styled-components/macro'\n\nimport {\n  useAllTokens,\n  useIsUserAddedToken,\n  useNativeCurrency,\n  useSearchInactiveTokenLists,\n  useToken,\n} from '../../hooks/Tokens'\nimport { useActiveWeb3React } from '../../hooks/web3'\nimport { ButtonText, CloseIcon, IconWrapper, ThemedText } from '../../theme'\nimport { isAddress } from '../../utils'\nimport Column from '../Column'\nimport Row, { RowBetween, RowFixed } from '../Row'\nimport CommonBases from './CommonBases'\nimport CurrencyList from './CurrencyList'\nimport { filterTokens, useSortedTokensByQuery } from './filtering'\nimport ImportRow from './ImportRow'\nimport { useTokenComparator } from './sorting'\nimport { PaddedColumn, SearchInput, Separator } from './styleds'\n\nconst ContentWrapper = styled(Column)`\n  width: 100%;\n  flex: 1 1;\n  position: relative;\n`\n\nconst Footer = styled.div`\n  width: 100%;\n  border-radius: 20px;\n  padding: 20px;\n  border-top-left-radius: 0;\n  border-top-right-radius: 0;\n  background-color: ${({ theme }) => theme.bg1};\n  border-top: 1px solid ${({ theme }) => theme.bg2};\n`\n\ninterface CurrencySearchProps {\n  isOpen: boolean\n  onDismiss: () => void\n  selectedCurrency?: Currency | null\n  onCurrencySelect: (currency: Currency) => void\n  otherSelectedCurrency?: Currency | null\n  showCommonBases?: boolean\n  showCurrencyAmount?: boolean\n  disableNonToken?: boolean\n  showManageView: () => void\n  showImportView: () => void\n  setImportToken: (token: Token) => void\n}\n\nexport function CurrencySearch({\n  selectedCurrency,\n  onCurrencySelect,\n  otherSelectedCurrency,\n  showCommonBases,\n  showCurrencyAmount,\n  disableNonToken,\n  onDismiss,\n  isOpen,\n  showManageView,\n  showImportView,\n  setImportToken,\n}: CurrencySearchProps) {\n  const { chainId } = useActiveWeb3React()\n  const theme = useTheme()\n\n  // refs for fixed size lists\n  const fixedList = useRef<FixedSizeList>()\n\n  const [searchQuery, setSearchQuery] = useState<string>('')\n  const debouncedQuery = useDebounce(searchQuery, 200)\n\n  const [invertSearchOrder] = useState<boolean>(false)\n\n  const allTokens = useAllTokens()\n\n  // if they input an address, use it\n  const isAddressSearch = isAddress(debouncedQuery)\n\n  const searchToken = useToken(debouncedQuery)\n\n  const searchTokenIsAdded = useIsUserAddedToken(searchToken)\n\n  useEffect(() => {\n    if (isAddressSearch) {\n      ReactGA.event({\n        category: 'Currency Select',\n        action: 'Search by address',\n        label: isAddressSearch,\n      })\n    }\n  }, [isAddressSearch])\n\n  const tokenComparator = useTokenComparator(invertSearchOrder)\n\n  const filteredTokens: Token[] = useMemo(() => {\n    return filterTokens(Object.values(allTokens), debouncedQuery)\n  }, [allTokens, debouncedQuery])\n\n  const sortedTokens: Token[] = useMemo(() => {\n    return filteredTokens.sort(tokenComparator)\n  }, [filteredTokens, tokenComparator])\n\n  const filteredSortedTokens = useSortedTokensByQuery(sortedTokens, debouncedQuery)\n\n  const native = useNativeCurrency()\n\n  const filteredSortedTokensWithETH: Currency[] = useMemo(() => {\n    if (!native) return filteredSortedTokens\n\n    const s = debouncedQuery.toLowerCase().trim()\n    if (native.symbol?.toLowerCase()?.indexOf(s) !== -1) {\n      return native ? [native, ...filteredSortedTokens] : filteredSortedTokens\n    }\n    return filteredSortedTokens\n  }, [debouncedQuery, native, filteredSortedTokens])\n\n  const handleCurrencySelect = useCallback(\n    (currency: Currency) => {\n      onCurrencySelect(currency)\n      onDismiss()\n    },\n    [onDismiss, onCurrencySelect]\n  )\n\n  // clear the input on open\n  useEffect(() => {\n    if (isOpen) setSearchQuery('')\n  }, [isOpen])\n\n  // manage focus on modal show\n  const inputRef = useRef<HTMLInputElement>()\n  const handleInput = useCallback((event) => {\n    const input = event.target.value\n    const checksummedInput = isAddress(input)\n    setSearchQuery(checksummedInput || input)\n    fixedList.current?.scrollTo(0)\n  }, [])\n\n  const handleEnter = useCallback(\n    (e: KeyboardEvent<HTMLInputElement>) => {\n      if (e.key === 'Enter') {\n        const s = debouncedQuery.toLowerCase().trim()\n        if (s === native?.symbol?.toLowerCase()) {\n          handleCurrencySelect(native)\n        } else if (filteredSortedTokensWithETH.length > 0) {\n          if (\n            filteredSortedTokensWithETH[0].symbol?.toLowerCase() === debouncedQuery.trim().toLowerCase() ||\n            filteredSortedTokensWithETH.length === 1\n          ) {\n            handleCurrencySelect(filteredSortedTokensWithETH[0])\n          }\n        }\n      }\n    },\n    [debouncedQuery, native, filteredSortedTokensWithETH, handleCurrencySelect]\n  )\n\n  // menu ui\n  const [open, toggle] = useToggle(false)\n  const node = useRef<HTMLDivElement>()\n  useOnClickOutside(node, open ? toggle : undefined)\n\n  // if no results on main list, show option to expand into inactive\n  const filteredInactiveTokens = useSearchInactiveTokenLists(\n    filteredTokens.length === 0 || (debouncedQuery.length > 2 && !isAddressSearch) ? debouncedQuery : undefined\n  )\n\n  return (\n    <ContentWrapper>\n      <PaddedColumn gap=\"16px\">\n        <RowBetween>\n          <Text fontWeight={500} fontSize={16}>\n            <Trans>Select a token</Trans>\n          </Text>\n          <CloseIcon onClick={onDismiss} />\n        </RowBetween>\n        <Row>\n          <SearchInput\n            type=\"text\"\n            id=\"token-search-input\"\n            placeholder={t`Search name or paste address`}\n            autoComplete=\"off\"\n            value={searchQuery}\n            ref={inputRef as RefObject<HTMLInputElement>}\n            onChange={handleInput}\n            onKeyDown={handleEnter}\n          />\n        </Row>\n        {showCommonBases && (\n          <CommonBases chainId={chainId} onSelect={handleCurrencySelect} selectedCurrency={selectedCurrency} />\n        )}\n      </PaddedColumn>\n      <Separator />\n      {searchToken && !searchTokenIsAdded ? (\n        <Column style={{ padding: '20px 0', height: '100%' }}>\n          <ImportRow token={searchToken} showImportView={showImportView} setImportToken={setImportToken} />\n        </Column>\n      ) : filteredSortedTokens?.length > 0 || filteredInactiveTokens?.length > 0 ? (\n        <div style={{ flex: '1' }}>\n          <AutoSizer disableWidth>\n            {({ height }) => (\n              <CurrencyList\n                height={height}\n                currencies={disableNonToken ? filteredSortedTokens : filteredSortedTokensWithETH}\n                otherListTokens={filteredInactiveTokens}\n                onCurrencySelect={handleCurrencySelect}\n                otherCurrency={otherSelectedCurrency}\n                selectedCurrency={selectedCurrency}\n                fixedListRef={fixedList}\n                showImportView={showImportView}\n                setImportToken={setImportToken}\n                showCurrencyAmount={showCurrencyAmount}\n              />\n            )}\n          </AutoSizer>\n        </div>\n      ) : (\n        <Column style={{ padding: '20px', height: '100%' }}>\n          <ThemedText.Main color={theme.text3} textAlign=\"center\" mb=\"20px\">\n            <Trans>No results found.</Trans>\n          </ThemedText.Main>\n        </Column>\n      )}\n      <Footer>\n        <Row justify=\"center\">\n          <ButtonText onClick={showManageView} color={theme.primary1} className=\"list-token-manage-button\">\n            <RowFixed>\n              <IconWrapper size=\"16px\" marginRight=\"6px\" stroke={theme.primaryText1}>\n                <Edit />\n              </IconWrapper>\n              <ThemedText.Main color={theme.primaryText1}>\n                <Trans>Manage Token Lists</Trans>\n              </ThemedText.Main>\n            </RowFixed>\n          </ButtonText>\n        </Row>\n      </Footer>\n    </ContentWrapper>\n  )\n}\n"]},"metadata":{},"sourceType":"module"}