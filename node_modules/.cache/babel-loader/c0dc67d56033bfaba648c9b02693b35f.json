{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.applyFilters = exports.ImageBase = void 0;\n\nvar ImageBase = function () {\n  function ImageBase() {}\n\n  ImageBase.prototype.scaleDown = function (opts) {\n    var width = this.getWidth();\n    var height = this.getHeight();\n    var ratio = 1;\n\n    if (opts.maxDimension > 0) {\n      var maxSide = Math.max(width, height);\n      if (maxSide > opts.maxDimension) ratio = opts.maxDimension / maxSide;\n    } else {\n      ratio = 1 / opts.quality;\n    }\n\n    if (ratio < 1) this.resize(width * ratio, height * ratio, ratio);\n  };\n\n  return ImageBase;\n}();\n\nexports.ImageBase = ImageBase;\n\nfunction applyFilters(imageData, filters) {\n  if (filters.length > 0) {\n    var pixels = imageData.data;\n    var n = pixels.length / 4;\n    var offset = void 0;\n    var r = void 0;\n    var g = void 0;\n    var b = void 0;\n    var a = void 0;\n\n    for (var i = 0; i < n; i++) {\n      offset = i * 4;\n      r = pixels[offset + 0];\n      g = pixels[offset + 1];\n      b = pixels[offset + 2];\n      a = pixels[offset + 3]; // Mark ignored color\n\n      for (var j = 0; j < filters.length; j++) {\n        if (!filters[j](r, g, b, a)) {\n          pixels[offset + 3] = 0;\n          break;\n        }\n      }\n    }\n  }\n\n  return imageData;\n}\n\nexports.applyFilters = applyFilters;","map":{"version":3,"sources":["../../../../packages/vibrant-image/src/index.ts"],"names":[],"mappings":";;;;;;;AAoCA,IAAA,SAAA,GAAA,YAAA;AAAA,WAAA,SAAA,GAAA,CA0BC;;AAfC,EAAA,SAAA,CAAA,SAAA,CAAA,SAAA,GAAA,UAAW,IAAX,EAA6B;AAC3B,QAAI,KAAK,GAAW,KAAK,QAAL,EAApB;AACA,QAAI,MAAM,GAAW,KAAK,SAAL,EAArB;AAEA,QAAI,KAAK,GAAW,CAApB;;AAEA,QAAI,IAAI,CAAC,YAAL,GAAoB,CAAxB,EAA2B;AACzB,UAAI,OAAO,GAAW,IAAI,CAAC,GAAL,CAAS,KAAT,EAAgB,MAAhB,CAAtB;AACA,UAAI,OAAO,GAAG,IAAI,CAAC,YAAnB,EAAiC,KAAK,GAAG,IAAI,CAAC,YAAL,GAAoB,OAA5B;AAClC,KAHD,MAGO;AACL,MAAA,KAAK,GAAG,IAAI,IAAI,CAAC,OAAjB;AACD;;AAED,QAAI,KAAK,GAAG,CAAZ,EAAe,KAAK,MAAL,CAAY,KAAK,GAAG,KAApB,EAA2B,MAAM,GAAG,KAApC,EAA2C,KAA3C;AAChB,GAdD;;AAeF,SAAA,SAAA;AAAC,CA1BD,EAAA;;AAAsB,OAAA,CAAA,SAAA,GAAA,SAAA;;AA4BtB,SAAgB,YAAhB,CAA8B,SAA9B,EAAoD,OAApD,EAAqE;AACnE,MAAI,OAAO,CAAC,MAAR,GAAiB,CAArB,EAAwB;AACtB,QAAI,MAAM,GAAG,SAAS,CAAC,IAAvB;AACA,QAAI,CAAC,GAAG,MAAM,CAAC,MAAP,GAAgB,CAAxB;AACA,QAAI,MAAM,GAAA,KAAA,CAAV;AACA,QAAI,CAAC,GAAA,KAAA,CAAL;AACA,QAAI,CAAC,GAAA,KAAA,CAAL;AACA,QAAI,CAAC,GAAA,KAAA,CAAL;AACA,QAAI,CAAC,GAAA,KAAA,CAAL;;AACA,SAAK,IAAI,CAAC,GAAG,CAAb,EAAgB,CAAC,GAAG,CAApB,EAAuB,CAAC,EAAxB,EAA4B;AAC1B,MAAA,MAAM,GAAG,CAAC,GAAG,CAAb;AACA,MAAA,CAAC,GAAG,MAAM,CAAC,MAAM,GAAG,CAAV,CAAV;AACA,MAAA,CAAC,GAAG,MAAM,CAAC,MAAM,GAAG,CAAV,CAAV;AACA,MAAA,CAAC,GAAG,MAAM,CAAC,MAAM,GAAG,CAAV,CAAV;AACA,MAAA,CAAC,GAAG,MAAM,CAAC,MAAM,GAAG,CAAV,CAAV,CAL0B,CAM1B;;AACA,WAAK,IAAI,CAAC,GAAG,CAAb,EAAgB,CAAC,GAAG,OAAO,CAAC,MAA5B,EAAoC,CAAC,EAArC,EAAyC;AACvC,YAAI,CAAC,OAAO,CAAC,CAAD,CAAP,CAAW,CAAX,EAAc,CAAd,EAAiB,CAAjB,EAAoB,CAApB,CAAL,EAA6B;AAC3B,UAAA,MAAM,CAAC,MAAM,GAAG,CAAV,CAAN,GAAqB,CAArB;AACA;AACD;AACF;AACF;AACF;;AAED,SAAO,SAAP;AACD;;AA1BD,OAAA,CAAA,YAAA,GAAA,YAAA","sourceRoot":"","sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.applyFilters = exports.ImageBase = void 0;\nvar ImageBase = /** @class */ (function () {\n    function ImageBase() {\n    }\n    ImageBase.prototype.scaleDown = function (opts) {\n        var width = this.getWidth();\n        var height = this.getHeight();\n        var ratio = 1;\n        if (opts.maxDimension > 0) {\n            var maxSide = Math.max(width, height);\n            if (maxSide > opts.maxDimension)\n                ratio = opts.maxDimension / maxSide;\n        }\n        else {\n            ratio = 1 / opts.quality;\n        }\n        if (ratio < 1)\n            this.resize(width * ratio, height * ratio, ratio);\n    };\n    return ImageBase;\n}());\nexports.ImageBase = ImageBase;\nfunction applyFilters(imageData, filters) {\n    if (filters.length > 0) {\n        var pixels = imageData.data;\n        var n = pixels.length / 4;\n        var offset = void 0;\n        var r = void 0;\n        var g = void 0;\n        var b = void 0;\n        var a = void 0;\n        for (var i = 0; i < n; i++) {\n            offset = i * 4;\n            r = pixels[offset + 0];\n            g = pixels[offset + 1];\n            b = pixels[offset + 2];\n            a = pixels[offset + 3];\n            // Mark ignored color\n            for (var j = 0; j < filters.length; j++) {\n                if (!filters[j](r, g, b, a)) {\n                    pixels[offset + 3] = 0;\n                    break;\n                }\n            }\n        }\n    }\n    return imageData;\n}\nexports.applyFilters = applyFilters;\n//# sourceMappingURL=index.js.map"]},"metadata":{},"sourceType":"script"}